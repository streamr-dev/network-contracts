type Bounty @entity {
  id: ID! # bounty address
  isRunning: Boolean!
  stakes: [Stake!]! @derivedFrom(field: "bounty")
  brokerCount: Int!
  totalStakedWei: BigInt!
  unallocatedWei: BigInt!
  projectedInsolvency: BigInt!
}

type Stake @entity {
  id: ID! # 0xbountyAddress-0xbrokerAddress
  broker: String!
  amount: BigInt!
  allocatedWei: BigInt!
  date: BigInt
  bounty: Bounty
  pool: BrokerPool 
}

type BrokerPool @entity {
  id: ID! # pool address
  stakes: [Stake!]! @derivedFrom(field: "pool")
  delegators: [PoolDelegation!]! @derivedFrom(field: "pool")
  delegatorCount: Int
  approximatePoolValue: BigInt!
  unallocatedWei: BigInt!
}

type PoolDelegation @entity {
  id: ID! # 0xpoolAddress-0xbrokerAddress
  delegator: String!
  amount: BigInt!
  pool: BrokerPool
}