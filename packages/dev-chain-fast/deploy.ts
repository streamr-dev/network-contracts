/* eslint-disable no-console */
import { StreamrEnvDeployer } from "@streamr/network-contracts"
import { HubEnvDeployer } from "@streamr/hub-contracts"
import { Wallet } from "ethers"
async function main() {
    // hardhat node mockchain (first priv key auto-generated by hardhat)
    const key = "0x5e98cce00cff5dea6b454889f359a4ec06b9fa6b88e9d69b86de8e1c81887da0"
    const url = "http://127.0.0.1:8545"

    // sidechain key preloaded with ETH (from docker-dev-init)
    // const key = "0x2cd9855d17e01ce041953829398af7e48b24ece04ff9d0e183414de54dc52285"
    // const url = "http://10.200.10.1:8546"

    const streamrEnvDeployer = new StreamrEnvDeployer(key, url)

    await streamrEnvDeployer.deployEnvironment()
    await streamrEnvDeployer.createFundStakeSponsorshipAndOperator()
    await streamrEnvDeployer.deployEns()
    await streamrEnvDeployer.registerEnsName("streamrtest", new Wallet(key))

    console.log("Deploying Hub contracts...")
    const hubDeployer = new HubEnvDeployer(key, url, streamrEnvDeployer.addresses.StreamRegistry, 1337)
    await hubDeployer.deployCoreContracts()

    console.log("Deployed network contracts:")
    console.log(JSON.stringify(streamrEnvDeployer.addresses))
    console.log("Deployed hub contracts:")
    console.log(JSON.stringify(hubDeployer.addresses))
}

main()
