$ ./scripts/2024-12-13-deploy-to-iotex.sh                                                         [17:10:48]
+ declare -p KEY
+ echo 'Using deployer private key from environment variable KEY'
Using deployer private key from environment variable KEY
+ export CHAIN=iotex
+ CHAIN=iotex
+ export OUTPUT_FILE=addresses.json
+ OUTPUT_FILE=addresses.json
+ export SCRIPT_FILE=scripts/deployTokenomicsContracts.ts
+ SCRIPT_FILE=scripts/deployTokenomicsContracts.ts
+ npm run hardhatScript

> @streamr/network-contracts@7.1.1 hardhatScript
> hardhat run --network $CHAIN $SCRIPT_FILE

You have both ethereum-waffle and @nomicfoundation/hardhat-chai-matchers installed. They don't work correctly together, so please make sure you only use one.

We recommend you migrate to @nomicfoundation/hardhat-chai-matchers. Learn how to do it here: https://hardhat.org/migrate-from-waffle
 ·----------------------------------|--------------------------------|--------------------------------·
 |  Solc version: 0.8.13            ·  Optimizer enabled: true       ·  Runs: 100                     │
 ···································|································|·································
 |  Contract Name                   ·  Deployed size (KiB) (change)  ·  Initcode size (KiB) (change)  │
 ···································|································|·································
 |  AcceptEverythingPaymaster       ·                 3.571 (0.000)  ·                 3.694 (0.000)  │
 ···································|································|·································
 |  Address                         ·                 0.084 (0.000)  ·                 0.138 (0.000)  │
 ···································|································|·································
 |  AddressUpgradeable              ·                 0.084 (0.000)  ·                 0.138 (0.000)  │
 ···································|································|·································
 |  AddressUpgradeable              ·                 0.084 (0.000)  ·                 0.138 (0.000)  │
 ···································|································|·································
 |  AdminKickPolicy                 ·                11.931 (0.000)  ·                11.976 (0.000)  │
 ···································|································|·································
 |  BasicToken                      ·                 0.497 (0.000)  ·                 0.528 (0.000)  │
 ···································|································|·································
 |  BufferChainlink                 ·                 0.084 (0.000)  ·                 0.138 (0.000)  │
 ···································|································|·································
 |  CBORChainlink                   ·                 0.084 (0.000)  ·                 0.138 (0.000)  │
 ···································|································|·································
 |  Chainlink                       ·                 0.084 (0.000)  ·                 0.138 (0.000)  │
 ···································|································|·································
 |  ClonesUpgradeable               ·                 0.084 (0.000)  ·                 0.138 (0.000)  │
 ···································|································|·································
 |  DefaultDelegationPolicy         ·                18.962 (0.000)  ·                19.007 (0.000)  │
 ···································|································|·································
 |  DefaultExchangeRatePolicy       ·                18.966 (0.000)  ·                19.011 (0.000)  │
 ···································|································|·································
 |  DefaultLeavePolicy              ·                11.669 (0.000)  ·                11.714 (0.000)  │
 ···································|································|·································
 |  DefaultUndelegationPolicy       ·                19.318 (0.000)  ·                19.363 (0.000)  │
 ···································|································|·································
 |  ECDSA                           ·                 0.084 (0.000)  ·                 0.138 (0.000)  │
 ···································|································|·································
 |  ECDSAUpgradeable                ·                 0.084 (0.000)  ·                 0.138 (0.000)  │
 ···································|································|·································
 |  ENSCache                        ·                 7.256 (0.000)  ·                 7.967 (0.000)  │
 ···································|································|·································
 |  ENSCacheV1                      ·                 6.815 (0.000)  ·                 7.526 (0.000)  │
 ···································|································|·································
 |  ENSCacheV2Streamr               ·                 5.178 (0.000)  ·                 5.252 (0.000)  │
 ···································|································|·································
 |  ENSRegistry                     ·                 2.417 (0.000)  ·                 2.504 (0.000)  │
 ···································|································|·································
 |  ERC1967Proxy                    ·                 0.664 (0.000)  ·                 1.888 (0.000)  │
 ···································|································|·································
 |  ERC20                           ·                 2.190 (0.000)  ·                 2.832 (0.000)  │
 ···································|································|·································
 |  ERC20Mintable                   ·                 2.525 (0.000)  ·                 3.192 (0.000)  │
 ···································|································|·································
 |  ERC20Upgradeable                ·                 2.097 (0.000)  ·                 2.128 (0.000)  │
 ···································|································|·································
 |  FIFSRegistrar                   ·                 0.574 (0.000)  ·                 0.731 (0.000)  │
 ···································|································|·································
 |  Forwarder                       ·                 4.759 (0.000)  ·                 5.229 (0.000)  │
 ···································|································|·································
 |  GsnEip712Library                ·                 1.294 (0.000)  ·                 1.351 (0.000)  │
 ···································|································|·································
 |  GsnUtils                        ·                 0.084 (0.000)  ·                 0.138 (0.000)  │
 ···································|································|·································
 |  LinkToken                       ·                 2.676 (0.000)  ·                 2.736 (0.000)  │
 ···································|································|·································
 |  MathUpgradeable                 ·                 0.084 (0.000)  ·                 0.138 (0.000)  │
 ···································|································|·································
 |  MaxOperatorsJoinPolicy          ·                11.454 (0.000)  ·                11.499 (0.000)  │
 ···································|································|·································
 |  MinimalForwarder                ·                 2.813 (0.000)  ·                 3.156 (0.000)  │
 ···································|································|·································
 |  MinimalForwarderUpgradeable     ·                 2.394 (0.000)  ·                 2.425 (0.000)  │
 ···································|································|·································
 |  MinLibBytes                     ·                 0.084 (0.000)  ·                 0.138 (0.000)  │
 ···································|································|·································
 |  MockRandomOracle                ·                 0.734 (0.000)  ·                 0.921 (0.000)  │
 ···································|································|·································
 |  NetworkParameters               ·                 1.621 (0.000)  ·                 2.296 (0.000)  │
 ···································|································|·································
 |  NodeDomainNameHelper            ·                 0.452 (0.000)  ·                 0.483 (0.000)  │
 ···································|································|·································
 |  NodeModule                      ·                20.818 (0.000)  ·                20.863 (0.000)  │
 ···································|································|·································
 |  NodeRegistry                    ·                 8.724 (0.000)  ·                 8.791 (0.000)  │
 ···································|································|·································
 |  Operator                        ·                18.695 (0.000)  ·                18.740 (0.000)  │
 ···································|································|·································
 |  OperatorContractOnlyJoinPolicy  ·                11.516 (0.000)  ·                11.561 (0.000)  │
 ···································|································|·································
 |  OperatorFactory                 ·                11.744 (0.000)  ·                11.830 (0.000)  │
 ···································|································|·································
 |  Oracle                          ·                 4.589 (0.000)  ·                 4.763 (0.000)  │
 ···································|································|·································
 |  Ownable                         ·                 0.551 (0.000)  ·                 0.694 (0.000)  │
 ···································|································|·································
 |  QueueModule                     ·                21.135 (0.000)  ·                21.180 (0.000)  │
 ···································|································|·································
 |  SafeMath                        ·                 0.084 (0.000)  ·                 0.138 (0.000)  │
 ···································|································|·································
 |  SafeMathChainlink               ·                 0.084 (0.000)  ·                 0.118 (0.000)  │
 ···································|································|·································
 |  SafeMathChainlink               ·                 0.074 (0.000)  ·                 0.117 (0.000)  │
 ···································|································|·································
 |  Sponsorship                     ·                11.184 (0.000)  ·                11.229 (0.000)  │
 ···································|································|·································
 |  SponsorshipFactory              ·                10.454 (0.000)  ·                10.540 (0.000)  │
 ···································|································|·································
 |  StakeModule                     ·                23.106 (0.000)  ·                23.152 (0.000)  │
 ···································|································|·································
 |  StakeWeightedAllocationPolicy   ·                13.097 (0.000)  ·                13.142 (0.000)  │
 ···································|································|·································
 |  StandardToken                   ·                 1.501 (0.000)  ·                 1.532 (0.000)  │
 ···································|································|·································
 |  StorageSlot                     ·                 0.084 (0.000)  ·                 0.138 (0.000)  │
 ···································|································|·································
 |  StorageSlotUpgradeable          ·                 0.084 (0.000)  ·                 0.138 (0.000)  │
 ···································|································|·································
 |  StorageSlotUpgradeable          ·                 0.084 (0.000)  ·                 0.138 (0.000)  │
 ···································|································|·································
 |  StreamrConfig                   ·                10.344 (0.000)  ·                10.418 (0.000)  │
 ···································|································|·································
 |  StreamrConfigV1_1               ·                10.505 (0.000)  ·                10.579 (0.000)  │
 ···································|································|·································
 |  StreamRegistry                  ·                20.528 (0.000)  ·                20.596 (0.000)  │
 ···································|································|·································
 |  StreamRegistryV2                ·                20.520 (0.000)  ·                20.587 (0.000)  │
 ···································|································|·································
 |  StreamRegistryV3                ·                22.183 (0.000)  ·                22.251 (0.000)  │
 ···································|································|·································
 |  StreamRegistryV4                ·                23.188 (0.000)  ·                23.257 (0.000)  │
 ···································|································|·································
 |  StreamRegistryV4_1              ·                23.265 (0.000)  ·                23.333 (0.000)  │
 ···································|································|·································
 |  StreamRegistryV5                ·                23.490 (0.000)  ·                23.559 (0.000)  │
 ···································|································|·································
 |  StreamRegistryV5_1              ·                23.567 (0.000)  ·                23.636 (0.000)  │
 ···································|································|·································
 |  StreamStorageRegistry           ·                 7.505 (0.000)  ·                 7.572 (0.000)  │
 ···································|································|·································
 |  StreamStorageRegistryV2         ·                 7.833 (0.000)  ·                 7.900 (0.000)  │
 ···································|································|·································
 |  Strings                         ·                 0.084 (0.000)  ·                 0.138 (0.000)  │
 ···································|································|·································
 |  StringsUpgradeable              ·                 0.084 (0.000)  ·                 0.138 (0.000)  │
 ···································|································|·································
 |  StringsUpgradeable              ·                 0.084 (0.000)  ·                 0.138 (0.000)  │
 ···································|································|·································
 |  TestAllocationPolicy            ·                12.381 (0.000)  ·                12.426 (0.000)  │
 ···································|································|·································
 |  TestBadOperator                 ·                 2.888 (0.000)  ·                 2.953 (0.000)  │
 ···································|································|·································
 |  TestExchangeRatePolicy          ·                 0.397 (0.000)  ·                 0.429 (0.000)  │
 ···································|································|·································
 |  TestExchangeRatePolicy2         ·                 0.464 (0.000)  ·                 0.495 (0.000)  │
 ···································|································|·································
 |  TestExchangeRatePolicy3         ·                 0.392 (0.000)  ·                 0.423 (0.000)  │
 ···································|································|·································
 |  TestJoinPolicy                  ·                11.453 (0.000)  ·                11.498 (0.000)  │
 ···································|································|·································
 |  TestKickPolicy                  ·                11.760 (0.000)  ·                11.805 (0.000)  │
 ···································|································|·································
 |  TestToken                       ·                 2.818 (0.000)  ·                 3.466 (0.000)  │
 ···································|································|·································
 |  TokenBalanceWeightStrategy      ·                 0.390 (0.000)  ·                 0.533 (0.000)  │
 ···································|································|·································
 |  TrackerRegistry                 ·                 5.609 (0.000)  ·                 8.042 (0.000)  │
 ···································|································|·································
 |  VoteKickPolicy                  ·                19.976 (0.000)  ·                20.021 (0.000)  │
 ···································|································|·································
 |  WeightedNodeRegistry            ·                 9.456 (0.000)  ·                 9.523 (0.000)  │
 ···································|································|·································
 |  WhitelistPaymaster              ·                 4.631 (0.000)  ·                 4.754 (0.000)  │
 ·----------------------------------|--------------------------------|--------------------------------·
You have both ethereum-waffle and @nomicfoundation/hardhat-chai-matchers installed. They don't work correctly together, so please make sure you only use one.

We recommend you migrate to @nomicfoundation/hardhat-chai-matchers. Learn how to do it here: https://hardhat.org/migrate-from-waffle
Connected to network { chainId: 4689, name: 'unknown' }
Estimated gas cost: 97.2 ETH (gas price 1620.0 gwei)
Balance of 0x72ea90e2Fe101090fc44156cae3141527AE9F429: 101.5822358 ETH
Found DATA token at 0x871a20C72d636A8C987e762616Ab047e1B52653e
Found StreamRegistry at 0x080F34fec2bc33928999Ea9e39ADc798bEF3E0d6
Found StreamrConfig at 0x23Dd2D1f39AD0f9d517ce56Ca490eF19B50e6f1A
Found OperatorFactory at 0xbC1cC84912d54fCf7316A6dA2e7A884731a87935
Deploying Sponsorship policies...
Deployed MaxOperatorsJoinPolicy; Streamr tokenomics contract addresses:
{
    "StreamrConfig": "0x23Dd2D1f39AD0f9d517ce56Ca490eF19B50e6f1A",
    "SponsorshipMaxOperatorsJoinPolicy": "0x845AEBfedD1AA70eD92E8a6b34117EF056A9c6d0",
    "OperatorFactory": "0xbC1cC84912d54fCf7316A6dA2e7A884731a87935"
}
Deployed OperatorContractOnlyJoinPolicy; Streamr tokenomics contract addresses:
{
    "StreamrConfig": "0x23Dd2D1f39AD0f9d517ce56Ca490eF19B50e6f1A",
    "SponsorshipOperatorContractOnlyJoinPolicy": "0x72b3278b7096DC198b42563e72Eb0D11fb35a074",
    "SponsorshipMaxOperatorsJoinPolicy": "0x845AEBfedD1AA70eD92E8a6b34117EF056A9c6d0",
    "OperatorFactory": "0xbC1cC84912d54fCf7316A6dA2e7A884731a87935"
}
Deployed StakeWeightedAllocationPolicy; Streamr tokenomics contract addresses:
{
    "StreamrConfig": "0x23Dd2D1f39AD0f9d517ce56Ca490eF19B50e6f1A",
    "SponsorshipOperatorContractOnlyJoinPolicy": "0x72b3278b7096DC198b42563e72Eb0D11fb35a074",
    "SponsorshipMaxOperatorsJoinPolicy": "0x845AEBfedD1AA70eD92E8a6b34117EF056A9c6d0",
    "SponsorshipStakeWeightedAllocationPolicy": "0x547910a95556ceE76b09Fc2ECbf4c61830f950aA",
    "OperatorFactory": "0xbC1cC84912d54fCf7316A6dA2e7A884731a87935"
}
Deployed DefaultLeavePolicy; Streamr tokenomics contract addresses:
{
    "StreamrConfig": "0x23Dd2D1f39AD0f9d517ce56Ca490eF19B50e6f1A",
    "SponsorshipOperatorContractOnlyJoinPolicy": "0x72b3278b7096DC198b42563e72Eb0D11fb35a074",
    "SponsorshipMaxOperatorsJoinPolicy": "0x845AEBfedD1AA70eD92E8a6b34117EF056A9c6d0",
    "SponsorshipStakeWeightedAllocationPolicy": "0x547910a95556ceE76b09Fc2ECbf4c61830f950aA",
    "SponsorshipDefaultLeavePolicy": "0xFe376FF5baeA4C926F453eDf242378EBCa50696b",
    "OperatorFactory": "0xbC1cC84912d54fCf7316A6dA2e7A884731a87935"
}
Deployed VoteKickPolicy; Streamr tokenomics contract addresses:
{
    "StreamrConfig": "0x23Dd2D1f39AD0f9d517ce56Ca490eF19B50e6f1A",
    "SponsorshipOperatorContractOnlyJoinPolicy": "0x72b3278b7096DC198b42563e72Eb0D11fb35a074",
    "SponsorshipMaxOperatorsJoinPolicy": "0x845AEBfedD1AA70eD92E8a6b34117EF056A9c6d0",
    "SponsorshipStakeWeightedAllocationPolicy": "0x547910a95556ceE76b09Fc2ECbf4c61830f950aA",
    "SponsorshipDefaultLeavePolicy": "0xFe376FF5baeA4C926F453eDf242378EBCa50696b",
    "SponsorshipVoteKickPolicy": "0xa6dc2b0366757a4631Ad0e3271a2FD2FFDF383ec",
    "OperatorFactory": "0xbC1cC84912d54fCf7316A6dA2e7A884731a87935"
}
Deployed Sponsorship template at 0x1fb55196365Dde59857e6602C65C36F07dDF4389
Warning: Potentially unsafe deployment of contracts/OperatorTokenomics/SponsorshipFactory.sol:SponsorshipFactory

    You are using the `unsafeAllow.delegatecall` flag.

Deployed SponsorshipFactory; Streamr tokenomics contract addresses:
{
    "StreamrConfig": "0x23Dd2D1f39AD0f9d517ce56Ca490eF19B50e6f1A",
    "SponsorshipOperatorContractOnlyJoinPolicy": "0x72b3278b7096DC198b42563e72Eb0D11fb35a074",
    "SponsorshipMaxOperatorsJoinPolicy": "0x845AEBfedD1AA70eD92E8a6b34117EF056A9c6d0",
    "SponsorshipStakeWeightedAllocationPolicy": "0x547910a95556ceE76b09Fc2ECbf4c61830f950aA",
    "SponsorshipDefaultLeavePolicy": "0xFe376FF5baeA4C926F453eDf242378EBCa50696b",
    "SponsorshipVoteKickPolicy": "0xa6dc2b0366757a4631Ad0e3271a2FD2FFDF383ec",
    "SponsorshipFactory": "0xe4Ae8e6c5b6E85914738803ad73c111eF2618621",
    "OperatorFactory": "0xbC1cC84912d54fCf7316A6dA2e7A884731a87935"
}
Done adding trusted policies (https://iotexscan.io/tx/0xf14e946483adc3ad3f32234250593336af3e175072d2567dfdc1d846713760d1 )
Done setting StreamrConfig.operatorContractOnlyJoinPolicy (https://iotexscan.io/tx/0x60fdf868356a532018afdfe098f42c689365ae427d2573fc088f7dff90feea7f )
Done setting StreamrConfig.sponsorshipFactory (https://iotexscan.io/tx/0xce49383957eee1535207e11d44be68ea6ead942daeaaa10c64f8fd3bb9dedaf4 )
